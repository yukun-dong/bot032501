on:
  push:
    branches:
      - master
jobs:
  build:
    runs-on: ubuntu-latest
    env:
      TEAMSAPP_CLI_VERSION: "3.0.0"
      BOT_AZURE_APP_SERVICE_RESOURCE_ID: ${{vars.BOT_AZURE_APP_SERVICE_RESOURCE_ID}}
      BOT_ID: ${{vars.BOT_ID}}
      TEAMS_APP_ID: ${{vars.TEAMS_APP_ID}}
      APP_NAME_SUFFIX: ${{vars.APP_NAME_SUFFIX}}
      # Add extra environment variables here so that teamsapp cli can use them.

    steps:
      - name: "Checkout Github Action"
        uses: actions/checkout@master

      - name: Setup Node 20.x
        uses: actions/setup-node@v1
        with:
          node-version: "20.8.1"

      - name: "ls"
        run: |
          npm install -g typescript@5.4.3

      - name: install cli
        run: |
          npm install @microsoft/teamsapp-cli@${{env.TEAMSAPP_CLI_VERSION}}

      - name: "Install dependencies"
        run: |
          npm install

      - name: "Build app"
        run: |
          npm ls @types/fs-extra

      - name: "Build app"
        run: |
          npm ls fs-extra

      - name: "Build app"
        run: |
          npm run build --verbose